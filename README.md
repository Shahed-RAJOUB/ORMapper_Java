# ORMapper

## SWE3_Project to design an OR Mapper

## Used languages:

* Java
* Postgres

## Functionality:

* A Good ORM can lead to much less code and much less repetition in a project
* Allows the changes in Database technologies
* Queries should be generated by the mapper without even thinking about Dialect or how the transaction is happening.
* This Design is simplified to approach a simple application of OR Mapper using Java, Postgres Container in Docker
* Database tables are already present, and the Mapper enables the queries on these tables
* The mapper is designed Code first style following these steps:
    * Configuring the connection with the Database as settings in persistence layer
    * Adding the classes as tables and the properties as columns in Entity layer
    * Adding different functions 'Select, delete, insert, update, drop' in Services layer
    * Adding transactions services 'join, find' in Service layer
    * Model layer is used to show a demo of the ORMapper and uses annotations
    * Annotations layer to define the reflection function that will define the tables and the columns

## Data Model:

This ORM supports tables that has foreign keys to refer to other tables and connect to them. as an example for 1-n
relationship:
![](1-n.png)

as an example for n-m relationship:
![](n-m.png)

SQL Script could be like the following:

```
create table if not exists test
(
	id bigserial
		constraint test_pk
			primary key,
	"testName" varchar
);

alter table test owner to postgres;

create table if not exists customers
(
	customer_id integer generated always as identity
		constraint customers_pkey
			primary key,
	customer_name varchar(255) not null
);

alter table customers owner to postgres;

create table if not exists contacts
(
	contact_id integer generated always as identity
		constraint contacts_pkey
			primary key,
	customer_id integer
		constraint fk_customer
			references customers,
	contact_name varchar(255) not null,
	phone varchar(15),
	email varchar(100)
);

alter table contacts owner to postgres;
```
 The most important thing is to choose Primary key as serial that increments automatically.

## Manual:

The following steps explain how to use this ORM :

1. Create a Postgres Database Docker Container. It could be #something like this:
   > <p> <em>$ docker run --name Database -p 5432:5432 -e POSTGRES_PASSWORD=if19b166 -d postgres</em></p>
2. Adding url, username, password to Config.xml in Settings folder.
3. Create a new ORM object where it is needed.
4. Create classes as entities with annotations to connect to the tables in DB

> <p>@table -----------> for a class</p> 
> <p>@Column ----------> for a property</p>
> <p>@PrimaryKey-------> for unique ids</p>
> <p>@ForeignKey-------> for foreign ids</p>
> <p>@IgnoreProperty---> to ignore a property </p>
5. ORM can make the calls to our database and save them in lists of objects.
6. The following functions can be used to fulfill the needs of this ORM:
   1. SelectAllRows
   2. SelectAllColumns
   3. SelectByID
   4. SelectbyColumn
   5. Insert
   6. DeleteRowbyId
   7. JoinbyForiegnKey
   8. Update


  